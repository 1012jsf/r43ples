{{<super}}

{{$script_extra}}
<script type="text/javascript">

	function setLocalClient(){
	  localStorage.clientName = document.getElementById("user").value;
	}

   
    // update branches for each selected graph
    $("#graph").change(function(){
 		$.get("api/getBranches", {graph : $(this).val() }, function(data,status){
        	var listitems = '' ;
        	$.each(data,function(key, value) {
        		listitems += '<option>' + value + '</option>';
        	});
        	$("#Branch1").html(listitems);
    		$("#Branch2").html(listitems);
        });
    });

        //js Stragegie->illustration with Graph
        
        function showIllustration(num){
          if(num == 0){
            document.getElementById("illustration").innerHTML="";
          }
          if(num == 1){
            document.getElementById("illustration").innerHTML="<img class=\"pull-left\" src=\"/static/images/fast-forward-strategie.png\" alt=\"fast-forward\" style=\"width:416px;height:466px;margin-left:6px\">";
          }
          if(num == 2){
            document.getElementById("illustration").innerHTML="<img class=\"pull-left\" src=\"/static/images/three-way-strategie.png\" alt=\"three-way\" style=\"width:416px;height:466px;margin-left:6px\">";
          }
          if(num == 3){ 
            document.getElementById("illustration").innerHTML="<img class=\"pull-left\" src=\"/static/images/rebase-strategie.png\" alt=\"rebase\"     style=\"width:416px;height:466px;margin-left:6px\">";
          }

          // by fast forward hide the common,auto fieldset and sdd selector
          if(num == 1){
            $('#methodField').hide();
            $('#sddField').hide();
          } else{
            $('#methodField').show();
            $('#sddField').show();
          }

        }; 

        // branch onchange check : if reachable with fast forward
        function checkFastForward (){
          var graph = $('#graph').val();
          var branch1 = $('#Branch1').val();
          var branch2 = $('#Branch2').val();

          $.get("fastForwardCheckProcess", 
            {
              graph : graph,
              branch1 : branch1,
              branch2 : branch2
            },
            function(data,status){
              // get data and check
              $('#strategie option[value="1"]').attr('disabled', true);
              if(data == "false"){
            	  $('#strategie option[value="1"]').attr('disabled', true);
              }else{
            	  $('#strategie option[value="1"]').attr('disabled', false);
            	  $('#strategie').val(1);
            	  showIllustration(1);
              }
            });
        }
</script>
{{/script_extra}}

{{$content}}
<div class="container">
			<div class="row" >
				<div class="col-sm-7">
                  <h3>Start Merging</h3>
                    <form class="form-horizontal" action="mergingProcess" method="post" role="form">
                      <div class="form-group" >
                      	<label for="graph" class="col-sm-2 control-label">Graph</label>
                        <div class="col-sm-10" >
                          <select class="form-control" id="graph" name="graph">
                             <option value="no">None</option>
                             {{#graphList}}
                             <option value="{{toString}}">{{toString}}</option>                        
                             {{/graphList}}
                          </select>
                        </div>
                      </div>
                      <div class="form-group">
                      	<label for="Branch1" class="col-sm-2 control-label">Merge</label>
                        <div class="col-sm-4">
                          <select class="form-control" id="Branch1" name="Branch1" onchange="checkFastForward()">    
                             <option value="no"></option>
                          </select>          
                        </div>
                        <label for="Branch2" class="col-sm-2 control-label">Into</label>
                        <div class="col-sm-4">
                          <select class="form-control" id="Branch2" name="Branch2" onchange="checkFastForward()">
                             <option value="no"></option>
                          </select>          
                        </div>
                      </div>
                      <div class="form-group" >
                        <label for="strategie" class="col-sm-2 control-label">Strategy</label>
                        <div class="col-sm-10" >
                          <select class="form-control" id="strategie" name="strategie" onchange="showIllustration(this.value)">
                             <option value="2">Three-Way Merge</option>
                             <option value="3">Rebase</option>
                             <option value="1">Fast-Forward</option>
                          </select>
                        </div>
                      </div>                    
                      <div id="methodField" class="form-group">
                      	<label class="col-sm-2 control-label">Method</label>
                              <label class="col-sm-5"><input type="radio" name="optradio" value="common" checked> Common</label>
                              <label class="col-sm-5"><input type="radio" name="optradio" value="auto"> Auto</label>
                      </div>
                      <div id="sddField" class="form-group" >
                          <label for="sdd" class="col-sm-2 control-label">SDD</label>
                          <div class="col-sm-10">          
                            <select class="form-control" id="sdd" name="sdd">
                             <option value="http://eatld.et.tu-dresden.de/sdd#defaultSDD">sdd:defaultSDD</option>
                            </select>
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="user" class="col-sm-2 control-label">User</label>
                          <div class="col-sm-10">
                            <input class="form-control" type="text" placeholder="User" id="user" name="user">
                          </div>
                       </div>    
                      <div class="form-group">
                           <label for="message" class="col-sm-2 control-label">Message</label>
                           <div class="col-sm-10 ">
                           	<textarea class="form-control" rows="6" id="message" name="message"></textarea>
                           </div>
                      </div>
                      <div class="form-group">
                          <div class="col-sm-offset-2 col-sm-5">
                            <button id="sub" type="submit" class="btn btn-primary btn-block" onclick="setLocalClient()">Submit</button>
                          </div>
                          <div class="col-sm-5">
                            <button id="can" type="button" class="btn btn-default btn-block">Cancel</button>
                          </div>
                      </div>
                    </form>

			 </div>

       <div class= "col-sm-5">
            <h3>Strategy Illustration</h3>
            <div class="panel-body" id="illustration" style="height:486px; width:406px ;">
            </div>
          </div>
		</div>
   </div>
{{/content}}


{{/super}}