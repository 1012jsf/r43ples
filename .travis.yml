language: java
jdk:
  - openjdk7

env:
  global:
   # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
   #   via the "travis encrypt" command using the project repo's public key
   - secure: "EWbOUn3lprcV7OiWMQLDUfR2kDyDHCvzPpUDNvoLG0YgdLpjymXgUGRuVdbiBdeiKER56WbkiZuNpqMyFoRQHozjjTvCHYrIofkwZJFK89GvvhxKKbkjS0XFS/3SiNytquhavF9TePX5CMqVb8KMqNVWzUtsTcFfhrgqni4QL2o="
   - secure: "WHUbL9LOlJo5a/6TewBV7BZgfpUzDnEur0uI3n5KxmbxGPnlSUYyLoaRFF83Ukys3Mb0xjdleLrOCk+EA7VFMtsxADroHGmK5tSPJD/GGWUo+jdmk1/cETKlgpPvOFKG5Ui19ydqMexACMGnzcy9XoyYwOMyIO/ZbrVjdrq3VtI="


addons:
  coverity_scan:
    project:
      name: "plt-tud/r43ples"
      description: "Revision Control for the Semantic Web"
    notification_email: markus.graube@tu-dresden.de
    build_command_prepend:
    build_command: ant
    branch_pattern: coverity_scan

before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -qq libc6 ibldap-2.4-2 libreadline6 libssl1.0.0
    - wget http://wwwpub.zih.tu-dresden.de/~mgraube/virtuoso-opensource_7.1_amd64.deb
    - sudo dpkg -i virtuoso-opensource_7.1_amd64.deb

  
after_success:
    - ./.coverity.sh
    - ant javadoc
    - git clone -b gh-pages https://$GITAUTH@github.com/plt-tud/r43ples
    - rm -rf r43ples/javadoc
    - cp -r javadoc r43ples/javadoc
    - cd r43ples/javadoc
    - git config --local user.email "r43ples-travis-ci@users.noreply.github.com"
    - git config --local user.name "r43ples travis-ci"
    - git config --local push.default simple
    - git add *
    - git commit -am "javadoc updated by travis-ci"
    - git push https://$GITAUTH@github.com/plt-tud/r43ples
